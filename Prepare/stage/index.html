<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Prepare/stage">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Stage | IBM Client Engineering</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://berretterry-ibm.github.io/solution-middleware-automation/img/logo.svg"><meta data-rh="true" name="twitter:image" content="https://berretterry-ibm.github.io/solution-middleware-automation/img/logo.svg"><meta data-rh="true" property="og:url" content="https://berretterry-ibm.github.io/solution-middleware-automation/Prepare/stage"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="ibm client engineering, open solutions library,  filenet, eks, aws, cp4ba, filenet on aws eks"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Stage | IBM Client Engineering"><meta data-rh="true" name="description" content="Requirements for the role"><meta data-rh="true" property="og:description" content="Requirements for the role"><link data-rh="true" rel="icon" href="/solution-middleware-automation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://berretterry-ibm.github.io/solution-middleware-automation/Prepare/stage"><link data-rh="true" rel="alternate" href="https://berretterry-ibm.github.io/solution-middleware-automation/Prepare/stage" hreflang="en"><link data-rh="true" rel="alternate" href="https://berretterry-ibm.github.io/solution-middleware-automation/Prepare/stage" hreflang="x-default"><link rel="stylesheet" href="/solution-middleware-automation/assets/css/styles.1116ef7f.css">
<link rel="preload" href="/solution-middleware-automation/assets/js/runtime~main.590dee84.js" as="script">
<link rel="preload" href="/solution-middleware-automation/assets/js/main.cb4c633a.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solution-middleware-automation/"><div class="navbar__logo"><img src="/solution-middleware-automation/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA" height="200" width="200"><img src="/solution-middleware-automation/img/logo-dark.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="200" width="200"></div><b class="navbar__title text--truncate">| Middleware Automation</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ibm-client-engineering/solution-filenet-aws" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solution-middleware-automation/">Flight Path</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solution-middleware-automation/category/innovate">Innovate</a><button aria-label="Toggle the collapsible sidebar category &#x27;Innovate&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/solution-middleware-automation/category/prepare">Prepare</a><button aria-label="Toggle the collapsible sidebar category &#x27;Prepare&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solution-middleware-automation/Prepare/learn">Learn</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solution-middleware-automation/Prepare/organize">Organize</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/solution-middleware-automation/Prepare/stage">Stage</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/solution-middleware-automation/CoCreate/deploy">CoCreate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solution-middleware-automation/category/transition">Transition</a><button aria-label="Toggle the collapsible sidebar category &#x27;Transition&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/solution-middleware-automation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solution-middleware-automation/category/prepare"><span itemprop="name">Prepare</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Stage</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Stage</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements-for-the-role">Requirements for the role<a href="#requirements-for-the-role" class="hash-link" aria-label="Direct link to Requirements for the role" title="Direct link to Requirements for the role">​</a></h2><p>At the moment this role requires a lot of specific settings in the inventory:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[mqipt_hosts]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqipt ansible_host=&lt;MQIPT HOST IP&gt; ansible_user=&lt;SYSTEM USER FOR ANSIBLE&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[washington]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ceng-wdc1-mq1 ansible_host=&lt;HOST IP 1&gt; mq_role=primary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ceng-wdc2-mq1 ansible_host=&lt;HOST IP 2&gt; mq_role=standby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ceng-wdc3-mq1 ansible_host=&lt;HOST IP 3&gt; mq_role=standby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[dallas]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ceng-dal1-mq1 ansible_host=&lt;HOST IP 4&gt; mq_role=primary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ceng-dal2-mq1 ansible_host=&lt;HOST IP 5&gt; mq_role=standby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ceng-dal3-mq1 ansible_host=&lt;HOST IP 6&gt; mq_role=standby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[washington:vars]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ansible_port=22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ansible_user=&lt;ANSIBLE USER IF DIFFERENT&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">queuemgr=&#x27;&lt;QUEUE MANAGER ON THIS CLUSTER&gt;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keypath=&#x27;/var/mqm/vols/&lt;QM&gt;/qmgr/&lt;QM&gt;/ssl/defaultSSLKeyFile.kdb&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private_key_file=keys/&lt;PATHTOSSHKEY&gt;_pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">load_balancer=&quot;&lt;OUR REGIONAL LOADBALANCER FOR THIS CLUSTER&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Add this line to inventory if using a bastion host as ssh proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ansible_ssh_common_args=&#x27;-l &lt;USER&gt; -i &lt;path to ssh pem&gt; -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand=&quot;ssh -l &lt;USER&gt; -i &lt;path to pem&gt; -W %h:%p -q &lt;BASTION HOST IP&quot;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[dallas:vars]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ansible_port=22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ansible_user=&lt;ANSIBLE USER IF DIFFERENT&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">queuemgr=&#x27;&lt;QUEUE MANAGER ON THIS CLUSTER&gt;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keypath=&#x27;/var/mqm/vols/&lt;QM&gt;/qmgr/&lt;QM&gt;/ssl/defaultSSLKeyFile.kdb&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private_key_file=keys/&lt;PATHTOSSHKEY&gt;_pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">load_balancer=&quot;&lt;OUR REGIONAL LOADBALANCER FOR THIS CLUSTER&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Add this line to inventory if using a bastion host as ssh proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ansible_ssh_common_args=&#x27;-l &lt;USER&gt; -i &lt;path to ssh pem&gt; -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand=&quot;ssh -l &lt;USER&gt; -i &lt;path to pem&gt; -W %h:%p -q &lt;BASTION HOST IP&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In our example above, we define the hosts and we set a <code>primary</code> node for each cluster. This isn&#x27;t conducive to failovers in this revision of the role.</p><p>We also set a <code>queuemgr</code> for each group as it&#x27;s specific to that cluster. The milage may vary on different types of MQ configurations, but this is a variable that can be overwritten at execution time.</p><p>Also in our example, ansible will connect as the root user. For future use, always configure a local user with the correct sudo permissions. This also necessitates the need to define a path to the ssh private key for ansible to use.</p><p>The <code>ansible_ssh_common_args</code> is used for ansible to connect if you are using a bastion host and not running on the same secured network</p><p>When importing this role, it&#x27;s important to also note that it is useful to have the following</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="role-tasks-and-variables">Role Tasks and Variables<a href="#role-tasks-and-variables" class="hash-link" aria-label="Direct link to Role Tasks and Variables" title="Direct link to Role Tasks and Variables">​</a></h2><p>When running this role from a Tower environment or running from cmdline, the following vars are required and/or overwriteable. This is a breakdown per task:</p><p><strong>Task:</strong> <code>mq-add-pub-cert.yaml</code></p><p>Description: This task allows for adding a trusted cert to a keystore.</p><p>Variables:</p><ul><li><code>cert_label</code> - The label the cert will be known by in the keystore.</li><li><code>cert_body</code> - The actual cert itself.</li><li><code>email_address</code> - The email address to send any updates for this task.</li><li><code>github_issue</code> - The github issue number we want to update with our status on this job.</li></ul><p>Tags: <code>addpubcert</code></p><p><strong>Task:</strong> <code>mq-create-keystore.yaml</code></p><p>Description: This task will create a new keystore for a queue manager and configure the qm to use it.</p><p>Variables:</p><ul><li><code>email_address</code> - The email address to send any updates for this task.</li><li><code>github_issue</code> - The github issue number we want to update with our status on this job.</li></ul><p>Tags: <code>createkeystore</code></p><p><strong>Task:</strong> <code>mq-getcerts.yaml</code></p><p>Description: Get a list of all certs that exist in a keystore and send a formatted email with them broken down between Trusted, Personal, and any generated CSRs.</p><p>Variables:</p><ul><li><code>email_address</code> - The email address to send any updates for this task.</li></ul><p>Tags: <code>getallcerts</code></p><p><strong>Task:</strong> <code>mq-get-cert-expirations.yaml</code></p><p>Description: Get a list of all certs that have imminent or expired dates.</p><p>Variables:</p><ul><li><code>email_address</code> - The email address to send any updates for this task.</li></ul><p>Tags: <code>listexpires</code></p><p><strong>Task:</strong> <code>mq-create-cert.yaml</code></p><p>Description: Create a new personal cert for the keystore and then extract and email the public cert so we can add it to any SSL peer and update any associated Github issue number with what we&#x27;ve done.</p><p>Variables:</p><ul><li><code>cert_label</code> - The label the cert will be known by in the keystore.</li><li><code>email_address</code> - The email address to send any updates for this task.</li><li><code>github_issue</code> - The github issue number we want to update with our status on this job.</li></ul><p>Tags: <code>createcert</code></p><p><strong>Task:</strong> <code>mq-get-pub-cert.yaml</code></p><p>Description: Extract and email the trusted cert for the named cert label we give.</p><p>Variables:</p><ul><li><code>cert_label</code> - The label the cert will be known by in the keystore.</li><li><code>email_address</code> - The email address to send any updates for this task.</li></ul><p>Tags: <code>getpubcert</code></p><p><strong>Task:</strong> <code>mq-remove-pub-cert.yaml</code></p><p>Description: Delete a Trusted cert from the keystores</p><p>Variables:</p><ul><li><code>cert_label</code> - The label the cert will be known by in the keystore.</li><li><code>email_address</code> - The email address to send any updates for this task.</li><li><code>github_issue</code> - The github issue number we want to update with our status on this job.</li></ul><p>Tags: <code>certremove</code></p><p><strong>Task:</strong> <code>mq-get-info.yaml</code></p><p>Description: This is a required task that is called via tags by any of the other tasks. It retrieves information from the keystore that is used by the other tasks. This task isn&#x27;t typically called directly. The type of info it returns are as such:</p><ul><li><p>Pulls the current keyfile path that is set in the queue manager</p></li><li><p>Pulls the current cert label that is set in the queue manager</p></li><li><p>Pulls the list of trusted certs</p></li><li><p>Pulls thelist of personal certs</p></li><li><p>Pulls the list of certs with expirations</p></li><li><p>Pulls a list of any unsigned CSRs that were created in the keystore</p><p>Tags: <code>getinfo, getpubcert, certremove, addpubcert, listexpires, createcert, getallcerts</code></p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dependencies">Dependencies<a href="#dependencies" class="hash-link" aria-label="Direct link to Dependencies" title="Direct link to Dependencies">​</a></h3><p>A list of other roles hosted on Galaxy should go here, plus any details in regards to parameters that may need to be set for other roles, or variables that are used from other roles.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="variables">Variables<a href="#variables" class="hash-link" aria-label="Direct link to Variables" title="Direct link to Variables">​</a></h3><p>For our orchestrator we would want to set some group vars for this role, particularly ansible vault encrypted tokens or passwords. For our test environment we set our <code>group_vars/all/main.yaml</code> with the following variables:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">smtp_info:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  host: smtp.sendgrid.net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  port: 465</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  user: apikey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pass: &quot;{{ smtp_pass }}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  auth: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  from: &quot;IBM Digital Business Automation on Cloud&lt;noreply@bpm.ibmcloud.com&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">email_address:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - Ross Kramer &lt;kramerro@us.ibm.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - Faraz Ahmad &lt;faraz@ibm.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">github_repo: &quot;https://github.com/api/v3/repos/ibm-client-engineering/solution-mq-certificate-management&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">github_issue: &quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">github_access_token: !vault |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          $ANSIBLE_VAULT;1.1;AES256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          64333133313831313363663861346637613663323439643731333264383831646137646637396436</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          3461353530386564616339383764303832333332333761340a643437343734643334626631616138</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          34613039383933616539306431616139363535643663373065643763646237343938386265363332</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          3962333439313930630a373031343033393165346662656131643361653162313730396465323264</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          3962333439313930630a373031343033393165346662656131643361653162313730396465323264</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          65643438353136643863333530376537363830346664613761376663346462616462653366643639</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          6336303230373363333533393663626266323539656337313336</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_pass: !vault |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          $ANSIBLE_VAULT;1.1;AES256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          32303333346433623861363861626466356331343934626531623633386234646234633066623731</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          6635656463346130326366666663383031393239336665310a393836633138376137666630663739</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          34373539393234363561333066323736646437663463326231383737333865343766363939366136</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          6433396233646365610a373132636633313761333734326237343335633131626364333065636564</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          66386239663337643064346231666163623333356538666363376466343535303165663265623139</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          32613335613262333132323264363964643534646337623938313164333031663736663139623265</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          65346362323331633163663964353134653431653532366266663433373338663064326335306234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          32393936613964643234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keystore_passwd: !vault |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          $ANSIBLE_VAULT;1.1;AES256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          36353763323034333765386265306165333936303832336336323132616532663739356438356563</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          3066653839656534393538643438633832613138373033310a343538333834383132333966326632</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          63653638313336653638646663633632616165376631303637636238343763613235386239326330</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          3164633530303338640a653036343735633135306539613633356634646233623435373263326435</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          3631</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Cert management stuff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sig_alg: &quot;SHA256WithRSA&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expire_time: 90</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We stored a lot of elements here in the global vars above. Primarily we do this so we can share the variables across multiple roles. These vars however can be very much localized into the role itself via <code>vars/main.yaml</code> or <code>defaults/main.yaml</code>.</p><p>The important variables are <code>smtp_info</code> as these are the required vars for the <code>mail</code> module in ansible. This allows us to email out. Others are the <code>github_repo</code> path. This is necessary in order to update our associated github issue. The <code>github_issue</code> var and <code>email_address</code> var are just populated with default values that we overwrite with our <code>extra_vars</code>.</p><p>Ansible vault encryption is how we are protecting our passwords and tokens. These entries are encrypted and are decrypted at run time using the ansible secret. That secret is typically stored in Tower or can be stored in a file to reference at run time when using the ansible-playbook command. Other vars like <code>sig_alg</code> and <code>expire_time</code> are also set to be default values to use when creating new certificates in the keystores.</p><p>Once again, any variable set here can be overwritten with the <code>extra-vars</code> flag when running via commandline.</p><p>Local Vars:</p><p>In our defaults dir we set some default vars. Currently it would look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># defaults file for mq-cert-management</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MQM_BIN_PATH: &quot;/opt/mqm/bin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">company_url: &quot;https://www.ibm.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">company_logo: &quot;https://www.freepnglogos.com/uploads/ibm-logo-png/ibm-logo-png-transparent-svg-vector-bie-supply-3.png&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This lets us set a default URL and default company logo to use for our email templates.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/solution-middleware-automation/Prepare/organize"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Organize</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/solution-middleware-automation/CoCreate/deploy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploy</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements-for-the-role" class="table-of-contents__link toc-highlight">Requirements for the role</a></li><li><a href="#role-tasks-and-variables" class="table-of-contents__link toc-highlight">Role Tasks and Variables</a><ul><li><a href="#dependencies" class="table-of-contents__link toc-highlight">Dependencies</a></li><li><a href="#variables" class="table-of-contents__link toc-highlight">Variables</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.ibm.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM</a></li><li class="footer__item"><a href="https://www.ibm.com/client-engineering" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM Client Engineering</a></li></ul></div></div></div></footer></div>
<script src="/solution-middleware-automation/assets/js/runtime~main.590dee84.js"></script>
<script src="/solution-middleware-automation/assets/js/main.cb4c633a.js"></script>
</body>
</html>